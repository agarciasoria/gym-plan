<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Progress Tracker</title>
<link rel="stylesheet" href="../assets/styles.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- === HEADER === -->
<header class="site-header">
  <div class="site-branding">
    <h1>Progress Tracker</h1>
  </div>
  <nav>
    <a href="../index.html">Home</a>
    <a href="../exercises/index.html">Exercises</a>
    <a href="progress.html">Progress Tracker</a>
  </nav>
</header>

<main class="container">
  <section>
    <h2>Record Your Workout</h2>

    <label for="workout">Select Workout:</label>
    <select id="workout">
      <option value="Day A">Day A</option>
      <option value="Day B">Day B</option>
    </select>

    <label for="exercise">Select Exercise:</label>
    <select id="exercise"></select>

    <label for="weight">Weight (kg):</label>
    <input type="number" id="weight" min="0">

    <label for="notes">Notes:</label>
    <textarea id="notes" rows="2"></textarea>

    <button id="save">Save Entry</button>
  </section>

  <section>
    <h2>Weight Progress</h2>
    <canvas id="chart" width="400" height="300"></canvas>
  </section>

  <section>
    <h2>Notes</h2>
    <ul id="notes-list"></ul>
  </section>
</main>

<footer class="site-footer">
  <p>Created for my sister â€” beginner to intermediate, full-body focused.</p>
</footer>

<script>
const workoutExercises = {
  "Day A": [
    "Goblet Squat",
    "Push-Ups",
    "Seated Row",
    "Shoulder Press",
    "Dumbbell Romanian Deadlift",
    "Plank"
  ],
  "Day B": [
    "Lat Pulldown",
    "Leg Extension",
    "Seated Bicep Curl",
    "Glute Machine / Walking Lunges",
    "Controlled Negative Pull-Ups",
    "Hanging Knee Raises"
  ]
};

const workoutSelect = document.getElementById('workout');
const exerciseSelect = document.getElementById('exercise');
const weightInput = document.getElementById('weight');
const notesInput = document.getElementById('notes');
const saveBtn = document.getElementById('save');
const notesList = document.getElementById('notes-list');
const ctx = document.getElementById('chart').getContext('2d');

let chart = new Chart(ctx, {
  type:'bar',
  data:{labels:[], datasets:[{label:'Weight (kg)', data:[], backgroundColor:'#2a7ae2'}]},
  options:{responsive:true, scales:{y:{beginAtZero:true}}}
});

function updateExerciseOptions(){
  const exercises = workoutExercises[workoutSelect.value];
  exerciseSelect.innerHTML = '';
  exercises.forEach(e => {
    const opt = document.createElement('option');
    opt.value = e;
    opt.textContent = e;
    exerciseSelect.appendChild(opt);
  });
  loadChart();
}

function loadChart(){
  const ex = exerciseSelect.value;
  const data = JSON.parse(localStorage.getItem('progress')||'[]').filter(x=>x.exercise===ex);

  chart.data.labels = data.map(d=>d.date);
  chart.data.datasets[0].data = data.map(d=>d.weight);
  chart.update();

  notesList.innerHTML = '';
  data.forEach((d,index)=>{
    const li = document.createElement('li');
    li.innerHTML = `${d.date}: ${d.weight}kg - ${d.notes||''} `;
    
    const delBtn = document.createElement('button');
    delBtn.textContent = 'Delete';
    delBtn.classList.add('delete-btn'); 
    delBtn.onclick = ()=>{ deleteEntry(d.date,d.exercise,d.weight,d.notes); };
    
    li.appendChild(delBtn);
    notesList.appendChild(li);
  });
}

function deleteEntry(date, exercise, weight, notes){
  let entries = JSON.parse(localStorage.getItem('progress')||'[]');
  entries = entries.filter(e => !(e.date===date && e.exercise===exercise && e.weight===weight && e.notes===notes));
  localStorage.setItem('progress', JSON.stringify(entries));
  loadChart();
}

workoutSelect.addEventListener('change', updateExerciseOptions);
exerciseSelect.addEventListener('change', loadChart);

saveBtn.addEventListener('click',()=>{
  if(weightInput.value==='') return alert('Please enter a weight');
  const entries = JSON.parse(localStorage.getItem('progress')||'[]');
  entries.push({
    date:new Date().toLocaleDateString(),
    workout:workoutSelect.value,
    exercise:exerciseSelect.value,
    weight:Number(weightInput.value),
    notes:notesInput.value
  });
  localStorage.setItem('progress', JSON.stringify(entries));
  weightInput.value=''; notesInput.value='';
  loadChart();
});

updateExerciseOptions();
</script>

</body>
</html>
